<div class="ground-booking-page" *ngIf="ground && !isLoading">
  <button class="back-btn" routerLink="/book-turf">‚Üê Back to Turfs</button>
  
  <div class="ground-header">
    <img [src]="ground.imageUrl || '/assets/images/turfs/default-turf.jpg'" [alt]="ground.name" class="ground-image" />
    <div class="ground-info">
      <h2>{{ ground.name }}</h2>
      <p class="location">üìç {{ ground.address }}, {{ ground.city }}</p>
      <p class="description">{{ ground.description }}</p>
      <div class="ground-details">
        <span class="sport">{{ ground.sportType }}</span>
        <span class="capacity">{{ ground.capacity }} players</span>
        <span class="status" [class.available]="ground.isAvailable" [class.unavailable]="!ground.isAvailable">
          {{ ground.isAvailable ? 'Available' : 'Unavailable' }}
        </span>
      </div>
      <div class="price">‚Çπ{{ ground.pricePerHour }} <span class="per">per hour</span></div>
    </div>
  </div>

  <!-- Timing Information -->
  <div class="timing-section" *ngIf="ground.timings?.length">
    <h3>Available Timings</h3>
    <div class="timing-grid">
      <div class="timing-card" *ngFor="let timing of ground.timings" [class.unavailable]="!timing.isAvailable">
        <div class="day">{{ timing.dayOfWeek }}</div>
        <div class="time">{{ timing.startTime }} - {{ timing.endTime }}</div>
        <div class="price">‚Çπ{{ timing.pricePerHour }}/hour</div>
        <div class="status">{{ timing.isAvailable ? 'Available' : 'Closed' }}</div>
      </div>
    </div>
  </div>

  <!-- Amenities -->
  <div class="amenities-section" *ngIf="getAvailableAmenities().length">
    <h3>Available Amenities</h3>
    <div class="amenities-grid">
      <div class="amenity-card" *ngFor="let amenity of getAvailableAmenities()">
        <div class="amenity-info">
          <h4>{{ amenity.name }}</h4>
          <p>{{ amenity.description }}</p>
        </div>
        <div class="amenity-cost" *ngIf="amenity.additionalCost">
          +‚Çπ{{ amenity.additionalCost }}
        </div>
        <div class="amenity-cost free" *ngIf="!amenity.additionalCost">
          Free
        </div>
      </div>
    </div>
  </div>

  <!-- Booking Form -->
  <form [formGroup]="bookingForm" (ngSubmit)="onSubmit()" class="booking-form">
    <h3>Book a Slot</h3>
    
    <div class="form-group">
      <label for="bookingDate">Date *</label>
      <input 
        type="date" 
        id="bookingDate" 
        formControlName="bookingDate"
        [min]="minDate"
        (change)="onDateChange()"
        required 
      />
      <div class="error" *ngIf="bookingForm.get('bookingDate')?.invalid && bookingForm.get('bookingDate')?.touched">
        Please select a valid date
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="startTime">Start Time *</label>
        <select id="startTime" formControlName="startTime" required>
          <option value="" disabled selected>Select start time</option>
          <option *ngFor="let slot of availableSlots" [value]="slot">{{ slot }}</option>
        </select>
        <div class="error" *ngIf="bookingForm.get('startTime')?.invalid && bookingForm.get('startTime')?.touched">
          Please select a start time
        </div>
      </div>

      <div class="form-group">
        <label for="endTime">End Time *</label>
        <select id="endTime" formControlName="endTime" required>
          <option value="" disabled selected>Select end time</option>
          <option *ngFor="let slot of availableSlots" [value]="slot">{{ slot }}</option>
        </select>
        <div class="error" *ngIf="bookingForm.get('endTime')?.invalid && bookingForm.get('endTime')?.touched">
          Please select an end time
        </div>
      </div>
    </div>

    <div class="booking-summary" *ngIf="calculateDuration() > 0">
      <div class="summary-item">
        <span>Duration:</span>
        <span>{{ calculateDuration() }} hour(s)</span>
      </div>
      <div class="summary-item">
        <span>Base Price:</span>
        <span>‚Çπ{{ ground.pricePerHour * calculateDuration() }}</span>
      </div>
      <div class="summary-item total">
        <span>Total Amount:</span>
        <span>‚Çπ{{ calculateTotalPrice() }}</span>
      </div>
    </div>

    <div class="form-group">
      <label for="specialRequests">Special Requests (Optional)</label>
      <textarea 
        id="specialRequests" 
        formControlName="specialRequests"
        placeholder="Any special requirements or requests..."
        rows="3"
      ></textarea>
    </div>

    <div class="error-message" *ngIf="error">
      {{ error }}
    </div>

    <button type="submit" class="book-btn" [disabled]="bookingForm.invalid || isSubmitting">
      {{ isSubmitting ? 'Processing...' : 'Book Now' }}
    </button>
  </form>
</div>

<!-- Loading State -->
<div class="loading-state" *ngIf="isLoading">
  <div class="loading-spinner"></div>
  <p>Loading ground details...</p>
</div>

<!-- Error State -->
<div class="error-state" *ngIf="error && !isLoading">
  <div class="error-icon">‚ö†Ô∏è</div>
  <h3>Oops! Something went wrong</h3>
  <p>{{ error }}</p>
  <button class="btn-primary" (click)="getGroundDetails(groundId!)">
    Try Again
  </button>
</div>
